!function(){const o=io({forceNew:!0});var t=window.location.pathname.split("/");const s=t[t.length-2],n=s+"-username",c=s+"-uuid",m=s+"-date";let i=JSON.parse(sessionStorage.getItem(n));i||window.location.replace("index.html");let d=JSON.parse(sessionStorage.getItem(c))||([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16));sessionStorage.setItem(c,JSON.stringify(d));let l=sessionStorage.getItem(m)||Date.now();o.emit("join-room",s);function a(t,r){o.on("redirect-game-finished",s=>{sessionStorage.removeItem(n),sessionStorage.removeItem(c),sessionStorage.removeItem(m);let i=s.find(t=>t.id===d),e=$("#gamification-message-modal");function a(t){t.find(".gamification-ranking").remove();let e=function(t,o){let e=$("<tr />").append($("<td/>").addClass("empty").attr("colspan",3).html("..."));t.sort((t,e)=>e.points-t.points);let a=t.filter((t,e)=>e<3||t===o),n=a.map(function(t,e){var a=$("<td />").html(e+1),n=$("<td />").html(t.username),e=$("<td />").html(t.points);return $("<tr />").toggleClass("current",t===o).append(a,n,e)});3<a.length&&n.splice(3,0,e.clone()),n.push(e.clone());var s=$("<tr />").append($("<th />").attr("colspan",3).html(r("gamification-results"))),t=$("<tr />").append($("<th />").html(r("gamification-position")),$("<th />").html(r("gamification-username")),$("<th />").html(r("gamification-points"))),s=$("<thead />").append(s,t),t=$("<tbody />").html(n);return $("<table/>").addClass("gamification-ranking table mx-auto").append(s,t)}(s,i);var a=i&&i.res?"https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-correct.png":"https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-wrong.png",n=i&&i.res?r("TextCorrectAnswer"):r("TextIncorrectAnswer"),o=i&&i.res?r("GamyCorrect"):r("GamyWrong");t.find(".modal-title").html(n),t.find(".modal-logo-img").attr("src",a).attr("alt",o),t.find(".modal-body").append(e),e.delay(1500).show(700),setTimeout(function(){t.removeClass("changing")},100)}if(e.hasClass("show")){let t=e.clone();e.css("opacity",0),setTimeout(function(){e.remove()},300),t.addClass("changing"),a(t),bootstrap.Modal.getOrCreateInstance(t[0],{keyboard:!0,focus:!0,backdrop:!1}).show()}else e.addClass("changing"),a(e),bootstrap.Modal.getOrCreateInstance(e[0],{keyboard:!0,focus:!0,backdrop:!1}).show()}),$(document).on("gamificate",".btn-gamification",function(t,e,a){let n=$("#gamification-message-modal");n.find(".modal-title").html(r("AnswerSent")),n.find(".modal-logo-img").attr("src","https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-ok.png").attr("alt",r("GamyGreeting")),bootstrap.Modal.getOrCreateInstance(n[0],{keyboard:!0,focus:!0,backdrop:!1}).show(),$(this).attr("disabled",!0),o.emit("question-response",{id:d,res:e,username:i,room:s,time:Date.now()-l,score:a})})}let r=document.currentScript.src;r=r.substr(0,r.lastIndexOf("/")),$(document).ready(function(){setTimeout(function(){$(".btn-gamification").attr("aria-haspopup","dialog")},500);let e=$("html").attr("lang");fetch(`${r}/../languages/${e}.json`).then(t=>t.json()).then(t=>i18next.createInstance({lng:e,resources:{[e]:{translation:t}}},a))})}();